---
import Tweet from "astro-tweet";
import Layout from "../../layouts/Layout.astro";
import Rules from "../../components/Rules.astro";
import H1 from "../../components/H1.astro";
import H2 from "../../components/H2.astro";
import { events, type Event } from "../../data/events";

export function getStaticPaths() {
  return events.map((event) => ({
    params: { slug: event.slug },
    props: { event },
  }));
}

const { event } = Astro.props as { event: Event };
const date = new Date(event.date);
const formattedDate = date.toLocaleString("ja-JP", {
  year: "numeric",
  month: "long",
  day: "numeric",
  weekday: "short",
  hour: "2-digit",
  minute: "2-digit",
  timeZoneName: "short",
  timeZone: "Asia/Tokyo",
});
---

<Layout
  title={`${event.title} | シピルカくん集会`}
  description={event.description}
>
  <article
    class="text-slate-900 rounded-[20px] border border-[rgba(255,255,255,0.3)] bg-[rgba(255,255,255,0.9)] p-6 shadow-[0_18px_42px_rgba(0,26,77,0.14),inset_0_0_0_0.5px_rgba(12,51,136,0.15)] max-[720px]:p-5"
  >
    <H1>{event.title}</H1>
    <dl
      class="my-4 grid grid-cols-[repeat(auto-fit,minmax(240px,1fr))] gap-y-[0.6rem] gap-x-4"
    >
      {
        event.tags && (
          <div>
            <dt class="font-bold text-[#34558f]">タグ</dt>
            <dd class="mt-[0.1rem] mb-0 flex flex-wrap gap-[0.4rem]">
              {event.tags.map((tag) => (
                <span class="inline-flex items-center gap-[0.35rem] rounded-full bg-[rgba(12,51,136,0.12)] px-[0.7rem] py-[0.25rem] text-[0.9rem] font-semibold text-[#0b1d3f]">
                  {tag}
                </span>
              ))}
            </dd>
          </div>
        )
      }
    </dl>

    <section>
      <H2>開催日時</H2>
      <p class="text-2xl xl:text-4xl">
        {formattedDate}
      </p>
    </section>

    <section>
      <H2>告知ツイート</H2>
      <p>
        {event.tweet && <Tweet id={event.tweet} />}
      </p>
    </section>

    {
      event.description && (
        <p class="mt-2 mb-[1.2rem] font-semibold leading-[1.7] text-[rgba(11,29,63,0.8)]">
          {event.description}
        </p>
      )
    }

    {
      event.content && (
        <div class="grid gap-[0.8rem]">
          {event.content.map((paragraph) => (
            <p class="m-0 leading-[1.7] text-[rgba(11,29,63,0.8)]">
              {paragraph}
            </p>
          ))}
        </div>
      )
    }

    {
      event.xPost && (
        <div class="mt-[1.2rem] rounded-[0.85rem] border border-[rgba(12,51,136,0.12)] bg-[rgba(12,51,136,0.07)] p-4">
          <a
            class="break-all font-bold text-[#0b1d3f] no-underline hover:underline"
            href={event.xPost}
            target="_blank"
            rel="noreferrer"
          >
            {event.xPost}
          </a>
        </div>
      )
    }

    <div class="mt-6">
      <Rules tone="dark" />
    </div>
  </article>
</Layout>
